<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L≈©y Th·ª´a S·ªë H·ªØu T·ª∑ - To√°n 7</title>
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title {
            font-size: 2.5rem;
            color: #4a5568;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .subtitle {
            font-size: 1.2rem;
            color: #718096;
            margin-bottom: 20px;
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .tab-btn {
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .tab-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .tab-btn.active {
            background: linear-gradient(45deg, #48bb78, #38b2ac);
        }

        .tab-content {
            display: none;
            background: #f7fafc;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .tab-content.active {
            display: block;
        }

        .fraction {
            display: inline-block;
            text-align: center;
            vertical-align: middle;
            margin: 0 5px;
        }

        .fraction .numerator {
            display: block;
            border-bottom: 2px solid #2d3748;
            padding-bottom: 2px;
            font-size: 1.1em;
        }

        .fraction .denominator {
            display: block;
            padding-top: 2px;
            font-size: 1.1em;
        }

        .input-group {
            display: flex;
            align-items: center;
            margin: 15px 0;
            flex-wrap: wrap;
            gap: 10px;
        }

        .input-group label {
            font-weight: bold;
            color: #2d3748;
            min-width: 100px;
        }

        .input-group input {
            padding: 8px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            width: 60px;
            text-align: center;
        }

        .input-group input:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
        }

        .btn {
            background: linear-gradient(45deg, #4299e1, #3182ce);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .result {
            background: linear-gradient(45deg, #48bb78, #38b2ac);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            font-size: 1.2em;
            text-align: center;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .example {
            background: #fff5f5;
            border-left: 4px solid #f56565;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 10px 10px 0;
        }

        .example h4 {
            color: #c53030;
            margin-top: 0;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e2e8f0;
            color: #718096;
            font-style: italic;
        }

        .power-display {
            font-size: 1.5em;
            margin: 15px 0;
            text-align: center;
            background: #edf2f7;
            padding: 15px;
            border-radius: 10px;
            border: 2px dashed #4299e1;
        }

        .comparison-result {
            font-size: 1.3em;
            font-weight: bold;
            color: #2d3748;
        }

        .quiz-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .score-display {
            display: flex;
            gap: 20px;
            font-weight: bold;
            color: #2d3748;
            font-size: 1.1em;
        }

        .question-type-selector {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .question-type-selector label {
            font-weight: bold;
            color: #2d3748;
            white-space: nowrap;
        }

        .type-dropdown {
            padding: 8px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
            min-width: 200px;
        }

        .type-dropdown:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
        }

        .quiz-container {
            background: #f7fafc;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .question-section {
            margin-bottom: 25px;
        }

        .question-display {
            background: #edf2f7;
            padding: 20px;
            border-radius: 10px;
            font-size: 1.3em;
            text-align: center;
            border: 2px solid #4299e1;
            margin: 15px 0;
        }

        .answers-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .answer-option {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            min-height: 60px;
        }

        .answer-option:hover {
            border-color: #4299e1;
            background: #ebf8ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .answer-option.selected {
            border-color: #3182ce;
            background: #bee3f8;
        }

        .answer-option.correct {
            border-color: #48bb78;
            background: #c6f6d5;
        }

        .answer-option.incorrect {
            border-color: #f56565;
            background: #fed7d7;
        }

        .option-label {
            font-weight: bold;
            font-size: 1.2em;
            color: #2d3748;
            min-width: 25px;
        }

        .option-content {
            font-size: 1.1em;
        }

        .explanation {
            background: #fff5f5;
            border-left: 4px solid #48bb78;
            padding: 15px;
            border-radius: 0 10px 10px 0;
            margin-top: 20px;
        }

        .explanation h4 {
            color: #2f855a;
            margin-top: 0;
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2rem;
            }
            
            .quiz-controls {
                flex-direction: column;
                align-items: center;
                gap: 20px;
            }
            
            .question-type-selector {
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }
            
            .type-dropdown {
                min-width: 250px;
            }
            
            .answers-section {
                grid-template-columns: 1fr;
            }
            
            .score-display {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">üéØ L≈©y Th·ª´a S·ªë H·ªØu T·ª∑</h1>
            <p class="subtitle">To√°n l·ªõp 7 - H·ªçc vui, hi·ªÉu s√¢u! üìö‚ú®</p>
        </div>

        <div class="quiz-controls">
            <div class="question-type-selector">
                <label for="question-type">üéØ Ch·ªçn d·∫°ng to√°n:</label>
                <select id="question-type" class="type-dropdown" onchange="generateQuestionByType()">
                    <option value="random">üé≤ Ng·∫´u nhi√™n</option>
                    <option value="calculate">üìä T√≠nh gi√° tr·ªã l≈©y th·ª´a</option>
                    <option value="write-compact">‚úèÔ∏è Vi·∫øt g·ªçn th√†nh l≈©y th·ª´a</option>
                    <option value="multiply">‚úñÔ∏è Nh√¢n hai l≈©y th·ª´a c√πng c∆° s·ªë</option>
                    <option value="divide">‚ûó Chia hai l≈©y th·ª´a c√πng c∆° s·ªë</option>
                    <option value="power-of-product">üî¢ L≈©y th·ª´a c·ªßa m·ªôt t√≠ch</option>
                    <option value="power-of-quotient">üìê L≈©y th·ª´a c·ªßa m·ªôt th∆∞∆°ng</option>
                    <option value="simplify">üéØ L≈©y th·ª´a c·ªßa l≈©y th·ª´a</option>
                    <option value="compare">‚öñÔ∏è So s√°nh hai l≈©y th·ª´a</option>
                    <option value="simplify-expression">üßÆ Thu g·ªçn l≈©y th·ª´a</option>
                </select>
            </div>
            <div class="score-display">
                <span>ƒêi·ªÉm: <span id="score">0</span></span>
                <span>C√¢u: <span id="question-count">1</span>/10</span>
                <span>ƒê√∫ng: <span id="correct-count">0</span>/<span id="total-answered">0</span></span>
                <span>T·ª∑ l·ªá: <span id="accuracy-rate">0%</span></span>
            </div>
        </div>

        <div class="quiz-container">
            <div class="question-section">
                <h3 id="question-title">üßÆ C√¢u h·ªèi 1: T√≠nh gi√° tr·ªã l≈©y th·ª´a</h3>
                <div class="question-display" id="question-display">
                    T√≠nh gi√° tr·ªã c·ªßa (<span class="fraction"><span class="numerator">2</span><span class="denominator">3</span></span>)<sup>2</sup>
                </div>
            </div>

            <div class="answers-section">
                <div class="answer-option" onclick="selectAnswer(0)">
                    <span class="option-label">A.</span>
                    <span class="option-content" id="option-0">
                        <span class="fraction"><span class="numerator">4</span><span class="denominator">9</span></span>
                    </span>
                </div>
                <div class="answer-option" onclick="selectAnswer(1)">
                    <span class="option-label">B.</span>
                    <span class="option-content" id="option-1">
                        <span class="fraction"><span class="numerator">4</span><span class="denominator">6</span></span>
                    </span>
                </div>
                <div class="answer-option" onclick="selectAnswer(2)">
                    <span class="option-label">C.</span>
                    <span class="option-content" id="option-2">
                        <span class="fraction"><span class="numerator">2</span><span class="denominator">6</span></span>
                    </span>
                </div>
                <div class="answer-option" onclick="selectAnswer(3)">
                    <span class="option-label">D.</span>
                    <span class="option-content" id="option-3">
                        <span class="fraction"><span class="numerator">8</span><span class="denominator">27</span></span>
                    </span>
                </div>
            </div>

            <div class="result" id="quiz-result">Ch·ªçn ƒë√°p √°n ƒë·ªÉ ki·ªÉm tra! üéØ</div>
            
            <div class="explanation" id="explanation" style="display: none;">
                <h4>üí° Gi·∫£i th√≠ch:</h4>
                <p id="explanation-text"></p>
            </div>
        </div>

        <div class="footer">
            <p>üé® Thi·∫øt k·∫ø: Thi·ªáp-H·∫°nh 2025 ‚ú®</p>
        </div>
    </div>

    <script>
        let currentQuestion = {};
        let score = 0;
        let questionCount = 1;
        let selectedAnswer = -1;
        let answered = false;
        let correctCount = 0;
        let totalAnswered = 0;

        const questionTypes = [
            'calculate', 'multiply', 'divide', 'simplify', 'compare', 'power-of-product', 'power-of-quotient'
        ];

        function gcd(a, b) {
            return b === 0 ? a : gcd(b, a % b);
        }

        function simplifyFraction(num, den) {
            const g = gcd(Math.abs(num), Math.abs(den));
            return [num / g, den / g];
        }

        function generateRandomFraction() {
            const num = Math.floor(Math.random() * 5) + 1; // 1-5
            const den = Math.floor(Math.random() * 5) + 2; // 2-6
            return [num, den];
        }

        function generateCalculateQuestion() {
            const [num, den] = generateRandomFraction();
            const exp = Math.floor(Math.random() * 3) + 2; // 2-4
            
            const correctNum = Math.pow(num, exp);
            const correctDen = Math.pow(den, exp);
            const [simplifiedNum, simplifiedDen] = simplifyFraction(correctNum, correctDen);
            
            const question = `T√≠nh gi√° tr·ªã c·ªßa (<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp}</sup>`;
            
            const correctAnswer = `<span class="fraction"><span class="numerator">${simplifiedNum}</span><span class="denominator">${simplifiedDen}</span></span>`;
            
            // T·∫°o ƒë√°p √°n sai
            const wrongAnswers = [
                `<span class="fraction"><span class="numerator">${num * exp}</span><span class="denominator">${den * exp}</span></span>`,
                `<span class="fraction"><span class="numerator">${correctNum}</span><span class="denominator">${correctDen + 1}</span></span>`,
                `<span class="fraction"><span class="numerator">${correctNum + 1}</span><span class="denominator">${correctDen}</span></span>`
            ];
            
            const explanation = `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp}</sup> = <span class="fraction"><span class="numerator">${num}<sup>${exp}</sup></span><span class="denominator">${den}<sup>${exp}</sup></span></span> = <span class="fraction"><span class="numerator">${correctNum}</span><span class="denominator">${correctDen}</span></span>${simplifiedNum !== correctNum ? ` = <span class="fraction"><span class="numerator">${simplifiedNum}</span><span class="denominator">${simplifiedDen}</span></span>` : ''}`;
            
            return {
                type: 'calculate',
                title: 'T√≠nh gi√° tr·ªã l≈©y th·ª´a',
                question,
                correctAnswer,
                wrongAnswers,
                explanation
            };
        }

        function generateMultiplyQuestion() {
            const [num, den] = generateRandomFraction();
            const exp1 = Math.floor(Math.random() * 3) + 1; // 1-3
            const exp2 = Math.floor(Math.random() * 3) + 1; // 1-3
            
            const question = `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp1}</sup> √ó (<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp2}</sup> b·∫±ng:`;
            
            const correctExp = exp1 + exp2;
            const correctAnswer = `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${correctExp}</sup>`;
            
            const wrongAnswers = [
                `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp1 * exp2}</sup>`,
                `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp1 - exp2}</sup>`,
                `(<span class="fraction"><span class="numerator">${num * 2}</span><span class="denominator">${den}</span></span>)<sup>${exp1}</sup>`
            ];
            
            const explanation = `Khi nh√¢n hai l≈©y th·ª´a c√πng c∆° s·ªë, ta c·ªông c√°c s·ªë m≈©: ${exp1} + ${exp2} = ${correctExp}`;
            
            return {
                type: 'multiply',
                title: 'Nh√¢n hai l≈©y th·ª´a c√πng c∆° s·ªë',
                question,
                correctAnswer,
                wrongAnswers,
                explanation
            };
        }

        function generateDivideQuestion() {
            const [num, den] = generateRandomFraction();
            const exp2 = Math.floor(Math.random() * 2) + 1; // 1-2
            const exp1 = exp2 + Math.floor(Math.random() * 3) + 1; // exp2 + 1 ƒë·∫øn exp2 + 3
            
            const question = `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp1}</sup> √∑ (<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp2}</sup> b·∫±ng:`;
            
            const correctExp = exp1 - exp2;
            const correctAnswer = correctExp === 1 ? 
                `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)` :
                `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${correctExp}</sup>`;
            
            const wrongAnswers = [
                `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp1 + exp2}</sup>`,
                `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp1 * exp2}</sup>`,
                `1`
            ];
            
            const explanation = `Khi chia hai l≈©y th·ª´a c√πng c∆° s·ªë, ta tr·ª´ c√°c s·ªë m≈©: ${exp1} - ${exp2} = ${correctExp}`;
            
            return {
                type: 'divide',
                title: 'Chia hai l≈©y th·ª´a c√πng c∆° s·ªë',
                question,
                correctAnswer,
                wrongAnswers,
                explanation
            };
        }

        function generateSimplifyQuestion() {
            const [num, den] = generateRandomFraction();
            const inner = Math.floor(Math.random() * 3) + 2; // 2-4
            const outer = Math.floor(Math.random() * 3) + 2; // 2-4
            
            const question = `[(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${inner}</sup>]<sup>${outer}</sup> b·∫±ng:`;
            
            const correctExp = inner * outer;
            const correctAnswer = `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${correctExp}</sup>`;
            
            const wrongAnswers = [
                `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${inner + outer}</sup>`,
                `(<span class="fraction"><span class="numerator">${num}<sup>${outer}</sup></span><span class="denominator">${den}<sup>${outer}</sup></span></span>)<sup>${inner}</sup>`,
                `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${inner}<sup>${outer}</sup></sup>`
            ];
            
            const explanation = `Khi c√≥ l≈©y th·ª´a c·ªßa l≈©y th·ª´a, ta nh√¢n c√°c s·ªë m≈©: ${inner} √ó ${outer} = ${correctExp}`;
            
            return {
                type: 'simplify',
                title: 'Thu g·ªçn l≈©y th·ª´a',
                question,
                correctAnswer,
                wrongAnswers,
                explanation
            };
        }

        function generateCompareQuestion() {
            const [num1, den1] = generateRandomFraction();
            const [num2, den2] = generateRandomFraction();
            const exp1 = Math.floor(Math.random() * 3) + 2;
            const exp2 = Math.floor(Math.random() * 3) + 2;
            
            const value1 = Math.pow(num1 / den1, exp1);
            const value2 = Math.pow(num2 / den2, exp2);
            
            const question = `So s√°nh (<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>)<sup>${exp1}</sup> v√† (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp2}</sup>`;
            
            let correctAnswer, symbol;
            if (value1 > value2) {
                symbol = '>';
                correctAnswer = `(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>)<sup>${exp1}</sup> > (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp2}</sup>`;
            } else if (value1 < value2) {
                symbol = '<';
                correctAnswer = `(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>)<sup>${exp1}</sup> < (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp2}</sup>`;
            } else {
                symbol = '=';
                correctAnswer = `(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>)<sup>${exp1}</sup> = (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp2}</sup>`;
            }
            
            const wrongAnswers = [
                symbol !== '>' ? `(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>)<sup>${exp1}</sup> > (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp2}</sup>` : `(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>)<sup>${exp1}</sup> < (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp2}</sup>`,
                symbol !== '<' ? `(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>)<sup>${exp1}</sup> < (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp2}</sup>` : `(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>)<sup>${exp1}</sup> > (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp2}</sup>`,
                symbol !== '=' ? `(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>)<sup>${exp1}</sup> = (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp2}</sup>` : `(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>)<sup>${exp1}</sup> > (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp2}</sup>`
            ];
            
            const explanation = `T√≠nh gi√° tr·ªã: ${value1.toFixed(4)} ${symbol} ${value2.toFixed(4)}`;
            
            return {
                type: 'compare',
                title: 'So s√°nh hai l≈©y th·ª´a',
                question,
                correctAnswer,
                wrongAnswers,
                explanation
            };
        }

        function generatePowerOfProductQuestion() {
            const num1 = Math.floor(Math.random() * 4) + 1; // 1-4
            const den1 = Math.floor(Math.random() * 4) + 2; // 2-5
            const num2 = Math.floor(Math.random() * 4) + 1; // 1-4
            const den2 = Math.floor(Math.random() * 4) + 2; // 2-5
            const exp = Math.floor(Math.random() * 3) + 2; // 2-4
            
            const question = `[(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>) √ó (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)]<sup>${exp}</sup> b·∫±ng:`;
            
            const correctAnswer = `(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>)<sup>${exp}</sup> √ó (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp}</sup>`;
            
            const wrongAnswers = [
                `(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>) √ó (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp}</sup>`,
                `(<span class="fraction"><span class="numerator">${num1 * num2}</span><span class="denominator">${den1 * den2}</span></span>)<sup>${exp}</sup>`,
                `(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>)<sup>${exp}</sup> + (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp}</sup>`
            ];
            
            const explanation = `L≈©y th·ª´a c·ªßa m·ªôt t√≠ch: (a √ó b)<sup>n</sup> = a<sup>n</sup> √ó b<sup>n</sup>`;
            
            return {
                type: 'power-of-product',
                title: 'L≈©y th·ª´a c·ªßa m·ªôt t√≠ch',
                question,
                correctAnswer,
                wrongAnswers,
                explanation
            };
        }

        function generatePowerOfQuotientQuestion() {
            const num1 = Math.floor(Math.random() * 4) + 2; // 2-5
            const den1 = Math.floor(Math.random() * 4) + 2; // 2-5
            const num2 = Math.floor(Math.random() * 3) + 1; // 1-3
            const den2 = Math.floor(Math.random() * 3) + 2; // 2-4
            const exp = Math.floor(Math.random() * 3) + 2; // 2-4
            
            const question = `[(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>) √∑ (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)]<sup>${exp}</sup> b·∫±ng:`;
            
            const correctAnswer = `(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>)<sup>${exp}</sup> √∑ (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp}</sup>`;
            
            const wrongAnswers = [
                `(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>) √∑ (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp}</sup>`,
                `<span class="fraction"><span class="numerator">(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>)<sup>${exp}</sup></span><span class="denominator">(<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)</span></span>`,
                `(<span class="fraction"><span class="numerator">${num1}</span><span class="denominator">${den1}</span></span>)<sup>${exp}</sup> - (<span class="fraction"><span class="numerator">${num2}</span><span class="denominator">${den2}</span></span>)<sup>${exp}</sup>`
            ];
            
            const explanation = `L≈©y th·ª´a c·ªßa m·ªôt th∆∞∆°ng: (a √∑ b)<sup>n</sup> = a<sup>n</sup> √∑ b<sup>n</sup>`;
            
            return {
                type: 'power-of-quotient',
                title: 'L≈©y th·ª´a c·ªßa m·ªôt th∆∞∆°ng',
                question,
                correctAnswer,
                wrongAnswers,
                explanation
            };
        }

        function generateWriteCompactQuestion() {
            const [num, den] = generateRandomFraction();
            const exp = Math.floor(Math.random() * 3) + 2; // 2-4
            
            // T·∫°o bi·ªÉu th·ª©c d·∫°ng a/b √ó a/b √ó ... √ó a/b (exp l·∫ßn)
            let expression = '';
            for (let i = 0; i < exp; i++) {
                if (i > 0) expression += ' √ó ';
                expression += `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)`;
            }
            
            const question = `Vi·∫øt g·ªçn bi·ªÉu th·ª©c sau th√†nh l≈©y th·ª´a: ${expression}`;
            
            const correctAnswer = `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp}</sup>`;
            
            const wrongAnswers = [
                `<span class="fraction"><span class="numerator">${num}<sup>${exp}</sup></span><span class="denominator">${den}</span></span>`,
                `<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}<sup>${exp}</sup></span></span>`,
                `<span class="fraction"><span class="numerator">${num * exp}</span><span class="denominator">${den * exp}</span></span>`
            ];
            
            const explanation = `Khi nh√¢n ${exp} th·ª´a s·ªë gi·ªëng nhau, ta vi·∫øt th√†nh l≈©y th·ª´a b·∫≠c ${exp}`;
            
            return {
                type: 'write-compact',
                title: 'Vi·∫øt g·ªçn th√†nh l≈©y th·ª´a',
                question,
                correctAnswer,
                wrongAnswers,
                explanation
            };
        }

        function generateSimplifyExpressionQuestion() {
            const [num, den] = generateRandomFraction();
            const exp1 = Math.floor(Math.random() * 3) + 2; // 2-4
            const exp2 = Math.floor(Math.random() * 3) + 2; // 2-4
            const exp3 = Math.floor(Math.random() * 2) + 1; // 1-2
            
            const question = `Thu g·ªçn bi·ªÉu th·ª©c: (<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp1}</sup> √ó (<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp2}</sup> √∑ (<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp3}</sup>`;
            
            const resultExp = exp1 + exp2 - exp3;
            const correctAnswer = resultExp === 1 ? 
                `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)` :
                `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${resultExp}</sup>`;
            
            const wrongAnswers = [
                `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp1 * exp2 - exp3}</sup>`,
                `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp1 + exp2 + exp3}</sup>`,
                `(<span class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></span>)<sup>${exp1 - exp2 + exp3}</sup>`
            ];
            
            const explanation = `Nh√¢n l≈©y th·ª´a c√πng c∆° s·ªë: c·ªông s·ªë m≈©. Chia l≈©y th·ª´a c√πng c∆° s·ªë: tr·ª´ s·ªë m≈©. ${exp1} + ${exp2} - ${exp3} = ${resultExp}`;
            
            return {
                type: 'simplify-expression',
                title: 'Thu g·ªçn l≈©y th·ª´a',
                question,
                correctAnswer,
                wrongAnswers,
                explanation
            };
        }

        function generateQuestionByType() {
            const selectedType = document.getElementById('question-type').value;
            
            if (questionCount > 10) {
                showFinalResult();
                return;
            }
            
            // Reset tr·∫°ng th√°i
            selectedAnswer = -1;
            answered = false;
            document.getElementById('explanation').style.display = 'none';
            document.getElementById('quiz-result').innerHTML = 'Ch·ªçn ƒë√°p √°n ƒë·ªÉ ki·ªÉm tra! üéØ';
            
            // X√≥a class t·ª´ c√°c ƒë√°p √°n
            document.querySelectorAll('.answer-option').forEach(option => {
                option.classList.remove('selected', 'correct', 'incorrect');
            });
            
            // T·∫°o c√¢u h·ªèi theo lo·∫°i ƒë∆∞·ª£c ch·ªçn
            let questionType;
            if (selectedType === 'random') {
                const questionTypes = [
                    'calculate', 'multiply', 'divide', 'simplify', 'compare', 
                    'power-of-product', 'power-of-quotient', 'write-compact', 'simplify-expression'
                ];
                questionType = questionTypes[Math.floor(Math.random() * questionTypes.length)];
            } else {
                questionType = selectedType;
            }
            
            switch(questionType) {
                case 'calculate':
                    currentQuestion = generateCalculateQuestion();
                    break;
                case 'write-compact':
                    currentQuestion = generateWriteCompactQuestion();
                    break;
                case 'multiply':
                    currentQuestion = generateMultiplyQuestion();
                    break;
                case 'divide':
                    currentQuestion = generateDivideQuestion();
                    break;
                case 'power-of-product':
                    currentQuestion = generatePowerOfProductQuestion();
                    break;
                case 'power-of-quotient':
                    currentQuestion = generatePowerOfQuotientQuestion();
                    break;
                case 'simplify':
                    currentQuestion = generateSimplifyQuestion();
                    break;
                case 'compare':
                    currentQuestion = generateCompareQuestion();
                    break;
                case 'simplify-expression':
                    currentQuestion = generateSimplifyExpressionQuestion();
                    break;
            }
            
            // Hi·ªÉn th·ªã c√¢u h·ªèi
            document.getElementById('question-title').innerHTML = `üßÆ C√¢u h·ªèi ${questionCount}: ${currentQuestion.title}`;
            document.getElementById('question-display').innerHTML = currentQuestion.question;
            
            // Tr·ªôn ƒë√°p √°n
            const allAnswers = [currentQuestion.correctAnswer, ...currentQuestion.wrongAnswers];
            const shuffledAnswers = shuffleArray(allAnswers);
            currentQuestion.correctIndex = shuffledAnswers.indexOf(currentQuestion.correctAnswer);
            
            // Hi·ªÉn th·ªã ƒë√°p √°n
            for (let i = 0; i < 4; i++) {
                document.getElementById(`option-${i}`).innerHTML = shuffledAnswers[i];
            }
        }

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function selectAnswer(index) {
            if (answered) return;
            
            selectedAnswer = index;
            answered = true;
            totalAnswered++;
            
            // Hi·ªÉn th·ªã k·∫øt qu·∫£
            const options = document.querySelectorAll('.answer-option');
            options[currentQuestion.correctIndex].classList.add('correct');
            
            if (index === currentQuestion.correctIndex) {
                score++;
                correctCount++;
                document.getElementById('quiz-result').innerHTML = 'üéâ Ch√≠nh x√°c! Tuy·ªát v·ªùi!';
            } else {
                options[index].classList.add('incorrect');
                document.getElementById('quiz-result').innerHTML = '‚ùå Sai r·ªìi! ƒê√°p √°n ƒë√∫ng ƒë∆∞·ª£c t√¥ m√†u xanh.';
            }
            
            // C·∫≠p nh·∫≠t th·ªëng k√™
            updateStatistics();
            
            // Hi·ªÉn th·ªã gi·∫£i th√≠ch
            document.getElementById('explanation-text').innerHTML = currentQuestion.explanation;
            document.getElementById('explanation').style.display = 'block';
            
            // T·ª± ƒë·ªông chuy·ªÉn c√¢u ti·∫øp theo sau 3 gi√¢y
            setTimeout(() => {
                questionCount++;
                document.getElementById('question-count').textContent = questionCount;
                generateQuestionByType();
            }, 3000);
        }

        function updateStatistics() {
            document.getElementById('score').textContent = score;
            document.getElementById('correct-count').textContent = correctCount;
            document.getElementById('total-answered').textContent = totalAnswered;
            
            const accuracyRate = totalAnswered > 0 ? Math.round((correctCount / totalAnswered) * 100) : 0;
            document.getElementById('accuracy-rate').textContent = accuracyRate + '%';
        }

        function showFinalResult() {
            const percentage = (score / 10) * 100;
            let message = '';
            
            if (percentage >= 90) {
                message = 'üèÜ Xu·∫•t s·∫Øc! B·∫°n ƒë√£ th√†nh th·∫°o l≈©y th·ª´a s·ªë h·ªØu t·ª∑!';
            } else if (percentage >= 70) {
                message = 'üëè T·ªët l·∫Øm! B·∫°n ƒë√£ hi·ªÉu kh√° t·ªët v·ªÅ l≈©y th·ª´a!';
            } else if (percentage >= 50) {
                message = 'üìö Kh√° ·ªïn! H√£y √¥n t·∫≠p th√™m ƒë·ªÉ c·∫£i thi·ªán!';
            } else {
                message = 'üí™ C·∫ßn c·ªë g·∫Øng th√™m! H√£y h·ªçc l·∫°i l√Ω thuy·∫øt nh√©!';
            }
            
            document.querySelector('.quiz-container').innerHTML = `
                <div style="text-align: center; padding: 40px;">
                    <h2>üéØ K·∫øt Qu·∫£ Cu·ªëi C√πng</h2>
                    <div style="font-size: 2em; margin: 20px 0; color: #4299e1;">
                        ${score}/10 ƒëi·ªÉm (${percentage}%)
                    </div>
                    <p style="font-size: 1.2em; margin: 20px 0;">${message}</p>
                    <button class="btn" onclick="restartQuiz()">üîÑ L√†m L·∫°i</button>
                </div>
            `;
        }

        function restartQuiz() {
            score = 0;
            questionCount = 1;
            correctCount = 0;
            totalAnswered = 0;
            
            // C·∫≠p nh·∫≠t hi·ªÉn th·ªã
            updateStatistics();
            document.getElementById('question-count').textContent = '1';
            
            // Kh√¥i ph·ª•c giao di·ªán quiz
            document.querySelector('.quiz-container').innerHTML = `
                <div class="question-section">
                    <h3 id="question-title">üßÆ C√¢u h·ªèi 1: T√≠nh gi√° tr·ªã l≈©y th·ª´a</h3>
                    <div class="question-display" id="question-display"></div>
                </div>
                <div class="answers-section">
                    <div class="answer-option" onclick="selectAnswer(0)">
                        <span class="option-label">A.</span>
                        <span class="option-content" id="option-0"></span>
                    </div>
                    <div class="answer-option" onclick="selectAnswer(1)">
                        <span class="option-label">B.</span>
                        <span class="option-content" id="option-1"></span>
                    </div>
                    <div class="answer-option" onclick="selectAnswer(2)">
                        <span class="option-label">C.</span>
                        <span class="option-content" id="option-2"></span>
                    </div>
                    <div class="answer-option" onclick="selectAnswer(3)">
                        <span class="option-label">D.</span>
                        <span class="option-content" id="option-3"></span>
                    </div>
                </div>
                <div class="result" id="quiz-result">Ch·ªçn ƒë√°p √°n ƒë·ªÉ ki·ªÉm tra! üéØ</div>
                <div class="explanation" id="explanation" style="display: none;">
                    <h4>üí° Gi·∫£i th√≠ch:</h4>
                    <p id="explanation-text"></p>
                </div>
            `;
            
            generateQuestionByType();
        }

        // Kh·ªüi t·∫°o c√¢u h·ªèi ƒë·∫ßu ti√™n
        generateQuestionByType();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'986f222b8771bd75',t:'MTc1OTE4NzIxMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
